################################################################################
# Smart Screen Session Manager - 推荐配置文件
# 基于 Screen 完整使用指南.md 中的最佳实践
################################################################################

# ==================== 基础设置 ====================

# 禁用启动消息
startup_message off

# 自动分离会话（网络断开时自动detach）
autodetach on

# 设置回滚缓冲区大小（增加到10000行）
defscrollback 10000

# 启用UTF-8支持
defutf8 on

# 设置默认shell
shell -$SHELL

# ==================== 状态栏设置 ====================

# 总是显示状态栏
hardstatus alwayslastline

# 详细状态栏格式 - 显示主机名、窗口列表、日期时间
# 格式：[主机名][窗口列表][日期时间]
hardstatus string '%{= kW}[ %{G}%H %{g}][%= %{= kw}%?%-Lw%?%{r}(%{W}%n*%f%t%?(%u)%?%{r})%{w}%?%+Lw%?%?%= %{g}][%{B} %d/%m %{W}%c %{g}]'

# 备用简化状态栏（如果需要更简洁的显示）
# hardstatus string '%{= kG}[ %{G}%H %{g}][%= %{= kw}%{=%}%?%-Lw%?%{r}%n*%f%t%?(%u)%?%{w}%?%+Lw%?%{=}%?%= %{g}][%{B} %m/%d %{W}%c %{g}]'

# ==================== 视觉设置 ====================

# 开启256色支持
term xterm-256color

# 启用鼠标滚动支持
termcapinfo xterm* ti@:te@

# 设置命令行转义字符
vbell on
vbell_msg "Bell in window %n"

# 设置窗口标题自动命名
shelltitle 'bash|terminal'

# ==================== 快捷键设置 ====================

# 设置escape键（默认为Ctrl+A，保持标准）
# escape ^Aa

# 窗口编号从1开始（而不是0）
bind c screen 1
bind ^c screen 1
bind 0 select 10

# 绑定窗口切换
bind j focus down
bind k focus up

# 绑定分割快捷键
bind s split
bind v split -v

# 关闭窗口快捷键
bind k screen -X kill
bind ^k screen -X kill
bind K screen -X quit

# ==================== 窗口监视 ====================

# 窗口活动监视
activity "Activity in window %n"
defmonitor on

# 静默监视（30秒无活动时通知）
silence 30

# ==================== 日志设置 ====================

# 默认开启日志记录
deflog on

# 日志文件路径（每个窗口一个日志文件）
logfile ~/screenlog-%n.log

# 日志时间戳（每60秒写入一次时间戳，减少I/O）
logtstamp after 60
logtstamp string "%n: %t-%d/%m/%y %c:%s "

# ==================== 复制模式设置 ====================

# 设置复制模式的光标样式（绿色）
# cursorcolor "#00ff00"

# ==================== 多用户设置 ====================

# 默认启用多用户模式（如果需要共享会话）
# multiuser on

# 设置socket权限（可选，根据需要调整）
# setgid screen
# setuid screen

# ==================== 性能优化 ====================

# 减少状态栏刷新频率
# （已在hardstatus string中优化）

# 减少日志I/O
# （已在logtstamp中配置）

# 减少窗口活动检测开销
# （已在silence中配置30秒间隔）

# ==================== 自动启动窗口 ====================

# 取消注释以自动启动窗口（可选）
# screen -t "Shell" bash
# screen -t "Monitor" htop
# screen -t "Logs" tail -f /var/log/messages

# ==================== 编码设置 ====================

# 设置编码
encoding UTF-8 zh_CN.UTF-8

# ==================== 其他实用设置 ====================

# 窗口自动标记
autodetach on

# 禁用视觉响铃
vbell off

# 设置终端标题更新间隔
# titlelen 50

# ==================== 高级功能 ====================

# 启用窗口切换时的视觉反馈
# defhstatus "screen ^E (^Et) | $USER@^EH"

# 设置会话启动后自动连接
# screen -r main || screen -S main

# ==================== 兼容性设置 ====================

# 为不同终端类型提供兼容性
termcapinfo xterm 'Co#256:AB=\E[48;5;%dm:AF=\E[38;5;%dm'

# 设置鼠标滚轮模式
termcapinfo xterm* 'XT:Ms=\E[%d%d;%u%u%d%d;%u%u%d%d;%u%u%d%d;%u%u%ds' 'hs:ts=\E]2;:fs=\007:ds=\E]2;screen\007'

# ==================== 样式设置 ====================

# 颜色方案（可选）
# caption always "%{= kW}%?%-Lw%?%{= BW}%n*%f %t%?(%u)%?%{= kW}%?%+Lw%?%?%= %{= kY} %H %{= kC} %ld/%l %{= kY} %{= kW}"

# ==================== 结尾 ====================

# 提示：此配置文件提供了Screen的最佳实践设置
# 如需自定义，请参考 Screen 完整使用指南.md
#
# 使用方法：
# 1. 复制此文件到 ~/.screenrc
# 2. 重启Screen会话或重新连接
# 3. 享受优化后的Screen体验
#
# 常用快捷键：
# - Ctrl+A ?    显示帮助
# - Ctrl+A c    创建新窗口
# - Ctrl+A 0-9  切换窗口
# - Ctrl+A d    分离会话
# - Ctrl+A [    进入复制模式
# - Ctrl+A S    水平分割
# - Ctrl+A |    垂直分割
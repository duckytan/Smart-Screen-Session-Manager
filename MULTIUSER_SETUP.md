# ğŸ” Screenå¤šç”¨æˆ·ä¼šè¯å®Œæ•´é…ç½®æŒ‡å—

## ğŸ“‹ é—®é¢˜æè¿°

**ç°è±¡**ï¼šAç”µè„‘å’ŒBç”µè„‘æ— æ³•åŒæ—¶è¿æ¥åŒä¸€ä¸ªScreenä¼šè¯ï¼Œå…ˆè¿›å»çš„ç”¨æˆ·ä¼šè¢«æŒ¤æ‰ã€‚

**æç¤ºä¿¡æ¯**ï¼š`[remote detached from 688581.dev-???????]`

## ğŸ¯ æ ¹æœ¬åŸå› 

Screenå¤šç”¨æˆ·ä¼šè¯éœ€è¦ï¼š
1. æ­£ç¡®çš„ä¼šè¯åˆ›å»ºæ–¹å¼
2. æ˜ç¡®çš„å¤šç”¨æˆ·æƒé™è®¾ç½®
3. æ­£ç¡®çš„è¿æ¥å‘½ä»¤æ ¼å¼

## âœ… è§£å†³æ–¹æ¡ˆ

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå¤šç”¨æˆ·ä¼šè¯

#### æ–¹æ³•1ï¼šæ‰‹åŠ¨åˆ›å»ºï¼ˆæ¨èç”¨äºå­¦ä¹ ï¼‰

```bash
# 1. åˆ›å»ºä¼šè¯
screen -S dev -d -m bash

# 2. ç­‰å¾…ä¼šè¯åˆ›å»ºï¼ˆé‡è¦ï¼ï¼‰
sleep 1

# 3. å¯ç”¨å¤šç”¨æˆ·æ¨¡å¼ï¼ˆå…³é”®æ­¥éª¤ï¼‰
screen -S dev -X multiuser on

# 4. æ·»åŠ ç”¨æˆ·æƒé™ï¼ˆå…³é”®æ­¥éª¤ï¼‰
screen -S dev -X acladd alice
screen -S dev -X acladd bob
```

#### æ–¹æ³•2ï¼šä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬

```bash
# åˆ›å»ºå¤šç”¨æˆ·ä¼šè¯
./create_multiuser_session.sh dev alice bob

# æŸ¥çœ‹åˆ›å»ºç»“æœ
screen -list
```

### ç¬¬äºŒæ­¥ï¼šä¸åŒç”¨æˆ·è¿æ¥

**é‡è¦**ï¼šä¸è¦ä½¿ç”¨ `screen -r` æˆ– `screen -dRR`ï¼

#### Aç”¨æˆ·ï¼ˆaliceï¼‰è¿æ¥ï¼š
```bash
screen -S alice/dev
# æˆ–è€…
screen -S root/dev  # å¦‚æœaliceè¦è¿æ¥åˆ°rootåˆ›å»ºçš„ä¼šè¯
```

#### Bç”¨æˆ·ï¼ˆbobï¼‰è¿æ¥ï¼š
```bash
screen -S bob/dev
# æˆ–è€…
screen -S root/dev  # å¦‚æœbobè¦è¿æ¥åˆ°rootåˆ›å»ºçš„ä¼šè¯
```

### ç¬¬ä¸‰æ­¥ï¼šéªŒè¯è¿æ¥

åœ¨å„è‡ªçš„ç»ˆç«¯ä¸­æ‰§è¡Œï¼š
```bash
screen -list
```

åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
There is a screen on:
    695842.dev    (Detached)
```

æˆ–ï¼ˆå¦‚æœå¤šç”¨æˆ·é…ç½®æ­£ç¡®ï¼‰ï¼š
```
There is a screen on:
    695842.root/dev    (Detached)
```

## ğŸ” è¯¦ç»†è§£é‡Š

### è¿æ¥æ ¼å¼è¯´æ˜

| æ ¼å¼ | å«ä¹‰ | ç¤ºä¾‹ |
|------|------|------|
| `screen -S <ä¼šè¯å>` | åˆ›å»ºæˆ–è¿æ¥è‡ªå·±çš„ä¼šè¯ | `screen -S dev` |
| `screen -S <ç”¨æˆ·å>/<ä¼šè¯å>` | è¿æ¥æŒ‡å®šç”¨æˆ·çš„ä¼šè¯ | `screen -S alice/dev` |
| `screen -r <ä¼šè¯å>` | æ¢å¤ä¼šè¯ï¼ˆå•äººæ¨¡å¼ï¼‰ | `screen -r dev` |
| `screen -dRR <ä¼šè¯å>` | å¼ºåˆ¶æ¢å¤ï¼ˆå•äººæ¨¡å¼ï¼‰ | `screen -dRR dev` |

### å…³é”®å‘½ä»¤è¯´æ˜

#### `multiuser on`
- å¯ç”¨ä¼šè¯çš„å¤šç”¨æˆ·æ¨¡å¼
- å¿…é¡»æ‰§è¡Œï¼Œå¦åˆ™å…¶ä»–ç”¨æˆ·æ— æ³•è¿æ¥
- ä¼šè¯çº§åˆ«è®¾ç½®ï¼Œåªå¯¹å½“å‰ä¼šè¯ç”Ÿæ•ˆ

#### `acladd <ç”¨æˆ·å>`
- ä¸ºæŒ‡å®šç”¨æˆ·æ·»åŠ è®¿é—®æƒé™
- å¯ä»¥æ‰§è¡Œå¤šæ¬¡ï¼Œä¸ºå¤šä¸ªç”¨æˆ·æˆæƒ
- ç”¨æˆ·å¿…é¡»å­˜åœ¨äºç³»ç»Ÿä¸­

## ğŸš¨ å¸¸è§é—®é¢˜

### Q1: æ‰§è¡Œmultiuser onæç¤º"Unknown command"
**A**: ä¼šè¯åç§°é”™è¯¯æˆ–ä¼šè¯ä¸å­˜åœ¨ã€‚æ£€æŸ¥ä¼šè¯åç§°ï¼š
```bash
screen -list
```

### Q2: æ‰§è¡Œacladdæç¤ºæƒé™é”™è¯¯
**A**: 
1. ç¡®ä¿ä»¥ä¼šè¯åˆ›å»ºè€…èº«ä»½æ‰§è¡Œ
2. ç¡®ä¿ç”¨æˆ·å­˜åœ¨ï¼š`id <username>`
3. æ£€æŸ¥screenæƒé™ï¼š`ls -la /var/run/screen/`

### Q3: è¿æ¥æ—¶ä»è¢«æŒ¤æ‰
**A**: 
1. æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†æ­£ç¡®çš„è¿æ¥æ ¼å¼
2. ç¡®ä¿æƒé™å·²æ·»åŠ 
3. é‡å¯ä¼šè¯é‡æ–°é…ç½®

### Q4: çœ‹ä¸åˆ°"(Multi, detached)"
**A**: å¤šç”¨æˆ·æ¨¡å¼æœªæ­£ç¡®å¯ç”¨ã€‚é‡æ–°æ‰§è¡Œï¼š
```bash
screen -S <ä¼šè¯å> -X multiuser on
```

## ğŸ› ï¸ å®ç”¨è„šæœ¬

### å¿«é€Ÿåˆ›å»ºè„šæœ¬

æˆ‘ä»¬å·²ç»åˆ›å»ºäº† `./create_multiuser_session.sh`ï¼š

```bash
# ç”¨æ³•
./create_multiuser_session.sh <ä¼šè¯å> <ç”¨æˆ·1> <ç”¨æˆ·2> ...

# ç¤ºä¾‹
./create_multiuser_session.sh project alice bob charlie
```

### æƒé™ç®¡ç†è„šæœ¬

```bash
# æ·»åŠ ç”¨æˆ·
screen -S <ä¼šè¯å> -X acladd <æ–°ç”¨æˆ·>

# ç§»é™¤ç”¨æˆ·
screen -S <ä¼šè¯å> -X acldel <ç”¨æˆ·>

# æŸ¥çœ‹æƒé™
screen -S <ä¼šè¯å> -X aclchg <ç”¨æˆ·> -r ?
```

### ä¼šè¯æ¸…ç†è„šæœ¬

```bash
# ç»ˆæ­¢ä¼šè¯
screen -S <ä¼šè¯å> -X quit

# æˆ–
screen -X -S <ä¼šè¯å> quit
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ä¼šè¯å‘½åè§„èŒƒ
- ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°ï¼š`project`, `dev`, `production`
- é¿å…ç‰¹æ®Šå­—ç¬¦
- ä¿æŒåç§°ç®€çŸ­

### 2. æƒé™ç®¡ç†
- åªæˆæƒç»™éœ€è¦çš„ç”¨æˆ·
- å®šæœŸå®¡æŸ¥æƒé™åˆ—è¡¨
- åŠæ—¶ç§»é™¤ç¦»èŒç”¨æˆ·æƒé™

### 3. ä¼šè¯ç”Ÿå‘½å‘¨æœŸ
- åˆ›å»º â†’ é…ç½® â†’ ä½¿ç”¨ â†’ æ¸…ç†
- ä¸è¦åˆ›å»ºè¿‡å¤šæ— ç”¨ä¼šè¯
- å®šæœŸæ¸…ç†åƒµå°¸ä¼šè¯

### 4. æ–‡æ¡£è®°å½•
- è®°å½•ä¼šè¯ç”¨é€”
- è®°å½•æˆæƒç”¨æˆ·åˆ—è¡¨
- è®°å½•ä¼šè¯åˆ›å»ºæ—¶é—´

## ğŸ“ ç¤ºä¾‹åœºæ™¯

### åœºæ™¯1ï¼šå¼€å‘åä½œ

**éœ€æ±‚**ï¼šAliceå’ŒBobéœ€è¦åŒæ—¶è®¿é—®å¼€å‘ç¯å¢ƒ

**æ“ä½œ**ï¼š
```bash
# Aliceæ‰§è¡Œï¼ˆä¼šè¯åˆ›å»ºè€…ï¼‰
screen -S dev -d -m bash
sleep 1
screen -S dev -X multiuser on
screen -S dev -X acladd bob
screen -S alice/dev  # Aliceè¿æ¥

# Bobæ‰§è¡Œ
screen -S alice/dev  # Bobè¿æ¥
```

### åœºæ™¯2ï¼šç”Ÿäº§ç¯å¢ƒç›‘æ§

**éœ€æ±‚**ï¼šè¿ç»´å›¢é˜Ÿéœ€è¦åŒæ—¶ç›‘æ§ç”Ÿäº§æœåŠ¡å™¨

**æ“ä½œ**ï¼š
```bash
# ç®¡ç†å‘˜æ‰§è¡Œ
screen -S prod_monitor -d -m bash
sleep 1
screen -S prod_monitor -X multiuser on
screen -S prod_monitor -X acladd operator1
screen -S prod_monitor -X acladd operator2
screen -S prod_monitor -X acladd operator3

# å„è¿ç»´äººå‘˜è¿æ¥
screen -S admin/prod_monitor
```

### åœºæ™¯3ï¼šæ•™å­¦ç¯å¢ƒ

**éœ€æ±‚**ï¼šè€å¸ˆå’Œå­¦ç”Ÿéœ€è¦å…±äº«ç»ˆç«¯è¿›è¡Œæ•™å­¦

**æ“ä½œ**ï¼š
```bash
# è€å¸ˆæ‰§è¡Œ
screen -S classroom -d -m bash
sleep 1
screen -S classroom -X multiuser on
screen -S classroom -X acladd student1
screen -S classroom -X acladd student2
screen -S classroom -X acladd student3

# å­¦ç”Ÿè¿æ¥
screen -S teacher/classroom
```

## ğŸ” å®‰å…¨æ³¨æ„äº‹é¡¹

1. **æƒé™æœ€å°åŒ–**ï¼šåªæˆæƒç»™éœ€è¦çš„ç”¨æˆ·
2. **å®šæœŸå®¡æŸ¥**ï¼šæ£€æŸ¥å“ªäº›ä¼šè¯ä»åœ¨ä½¿ç”¨
3. **æ•æ„Ÿæ“ä½œ**ï¼šå¤šç”¨æˆ·ä¼šè¯ä¸é€‚åˆæ‰§è¡Œæ•æ„Ÿå‘½ä»¤
4. **æ—¥å¿—ç›‘æ§**ï¼šå¯ç”¨screenæ—¥å¿—åŠŸèƒ½
5. **é€€å‡ºæ¸…ç†**ï¼šä½¿ç”¨å®Œæ¯•ååŠæ—¶é€€å‡ºå¹¶æ¸…ç†ä¼šè¯

## ğŸ“š å‚è€ƒèµ„æº

- Screenå®˜æ–¹æ‰‹å†Œï¼š`man screen`
- Screenå¤šç”¨æˆ·æ–‡æ¡£ï¼š`<screen>/doc/screen.1`
- åœ¨çº¿å¸®åŠ©ï¼š`screen -h`

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœæŒ‰ç…§æœ¬æŒ‡å—æ“ä½œåä»æœ‰é—®é¢˜ï¼š

1. æ£€æŸ¥Screenç‰ˆæœ¬ï¼š`screen -v`
2. æŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼š`tail -f /var/log/screen.log`
3. é‡å¯screenæœåŠ¡ï¼š`screen -wipe`
4. é‡æ–°é…ç½®ï¼š`./fix_ssh_multiuser.sh`

---

**ç‰ˆæœ¬**ï¼šv2.0  
**æ›´æ–°æ—¥æœŸ**ï¼š2026-01-20  
**ç»´æŠ¤è€…**ï¼šSmart Screen Team

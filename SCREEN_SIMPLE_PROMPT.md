# Screen ç®€æ´æç¤ºç¬¦é…ç½®æŒ‡å—

## ğŸ¯ é—®é¢˜è§£å†³

**åŸæç¤ºç¬¦**ï¼š
```
[screen 0: root@VM-0-8-opencloudos:~] [dev-[dev-å¼€å‘ç¯å¢ƒ] root@dev-å¼€å‘ç¯å¢ƒ$
```

**æ–°æç¤ºç¬¦**ï¼š
```
[dev-å¼€å‘ç¯å¢ƒ]root@VM-0-8-opencloudos$
```

## âœ… å·²å®Œæˆçš„é…ç½®

### 1. .screenrc é…ç½®
- âœ… è®¾ç½®äº†ç®€æ´çš„ hardstatus
- âœ… ç¦ç”¨äº†å¤šä½™çš„æ ‡é¢˜ä¿¡æ¯
- âœ… ä¿ç•™äº†ä¼šè¯åç§°æ˜¾ç¤º

### 2. PS1 é…ç½®
- âœ… åˆ›å»ºäº† ~/.screenrc.ps1
- âœ… æ·»åŠ åˆ° ~/.bashrc è‡ªåŠ¨åŠ è½½
- âœ… æ™ºèƒ½è·å–ä¼šè¯åç§°

### 3. æç¤ºç¬¦æ ¼å¼
- âœ… æ˜¾ç¤ºä¼šè¯åç§°
- âœ… æ˜¾ç¤ºç”¨æˆ·å
- âœ… æ˜¾ç¤ºä¸»æœºå
- âœ… ç§»é™¤äº†å¤šä½™è·¯å¾„ä¿¡æ¯

## ğŸš€ åº”ç”¨æ›´æ”¹

### æ–¹æ³•1ï¼šé‡æ–°è¿æ¥ä¼šè¯

```bash
# é€€å‡ºå½“å‰ä¼šè¯
# æŒ‰ Ctrl+A D

# é‡æ–°è¿æ¥ä¼šè¯
screen -xR "dev-å¼€å‘ç¯å¢ƒ"
```

### æ–¹æ³•2ï¼šåˆ›å»ºæ–°ä¼šè¯

```bash
# åˆ›å»ºæ–°ä¼šè¯
screen -S "dev-å¼€å‘ç¯å¢ƒ" -d -m bash

# è¿æ¥ä¼šè¯
screen -xR "dev-å¼€å‘ç¯å¢ƒ"
```

## ğŸ“‹ é…ç½®è¯¦æƒ…

### .screenrc é…ç½®

```bash
# ç®€æ´æç¤ºç¬¦é…ç½®
hardstatus alwayslastline
hardstatus string '%{= kG}[%{G}%S%{g}]%{W} %H %{g}%'
```

### PS1 é…ç½®

```bash
# è·å–Screenä¼šè¯åç§°
if [ -n "$STY" ]; then
    SESSION_NAME=$(echo $STY | cut -d. -f2)
else
    SESSION_NAME="screen"
fi

# è®¾ç½®ç®€æ´PS1
export PS1="\[\e]0;[\$SESSION_NAME] \u@\h:\w\a\]\\$ "
```

## ğŸ¨ è‡ªå®šä¹‰æç¤ºç¬¦

### ä¿®æ”¹ PS1 æ ¼å¼

ç¼–è¾‘ `~/.screenrc.ps1`ï¼š

```bash
# æ ¼å¼ï¼š[ä¼šè¯åç§°] ç”¨æˆ·@ä¸»æœº$
export PS1="\[\e]0;[\$SESSION_NAME] \u@\h:\w\a\]\\$ "

# æ ¼å¼ï¼š[ä¼šè¯åç§°] ç”¨æˆ·@ä¸»æœº:è·¯å¾„$
export PS1="\[\e]0;[\$SESSION_NAME] \u@\h:\w\a\]\\$ "

# æ ¼å¼ï¼š[ä¼šè¯åç§°] $
export PS1="\[\e]0;[\$SESSION_NAME] \a\]\\$ "
```

### ä¿®æ”¹ Hardstatus

ç¼–è¾‘ `~/.screenrc`ï¼š

```bash
# åªæ˜¾ç¤ºä¼šè¯åç§°
hardstatus string '%{= kG}[%{G}%S%{g}]%'

# æ˜¾ç¤ºä¼šè¯åç§°å’Œä¸»æœº
hardstatus string '%{= kG}[%{G}%S%{g}]%{W} %H %{g}%'

# æ˜¾ç¤ºä¼šè¯åç§°ã€ç”¨æˆ·å’Œä¸»æœº
hardstatus string '%{= kG}[%{G}%S%{g}]%{W} %n@%H %{g}%'
```

## ğŸ”§ æ•…éšœæ’é™¤

### Q: æç¤ºç¬¦ä»ç„¶å¾ˆé•¿

**A**: æ£€æŸ¥ PS1 é…ç½®
```bash
# æŸ¥çœ‹å½“å‰PS1
echo $PS1

# é‡æ–°åŠ è½½é…ç½®
source ~/.bashrc
```

### Q: ä¼šè¯åç§°æ˜¾ç¤ºä¸æ­£ç¡®

**A**: æ£€æŸ¥ STY ç¯å¢ƒå˜é‡
```bash
# æŸ¥çœ‹STY
echo $STY

# é‡æ–°åˆ›å»ºä¼šè¯
screen -S "test" -d -m bash
```

### Q: æç¤ºç¬¦æ˜¾ç¤ºå¼‚å¸¸

**A**: é‡ç½®é…ç½®
```bash
# åˆ é™¤é…ç½®æ–‡ä»¶
rm ~/.screenrc.ps1
rm ~/.screenrc

# é‡æ–°è¿è¡Œé…ç½®è„šæœ¬
./setup_screen_prompt.sh
```

## ğŸ“Š å¯¹æ¯”

| ç‰¹å¾ | åŸæç¤ºç¬¦ | æ–°æç¤ºç¬¦ |
|------|----------|----------|
| ä¼šè¯åç§° | âœ… | âœ… |
| ç”¨æˆ·å | âœ… | âœ… |
| ä¸»æœºå | âœ… | âœ… |
| å®Œæ•´è·¯å¾„ | âœ… | âŒ |
| screen æ ‡è¯† | âœ… | âŒ |
| å¤šä½™ä¿¡æ¯ | âœ… | âŒ |
| ç®€æ´æ€§ | âŒ | âœ… |

## ğŸ‰ æœ€ç»ˆæ•ˆæœ

### æ–°æç¤ºç¬¦ç¤ºä¾‹

```
[dev-å¼€å‘ç¯å¢ƒ]root@VM-0-8-opencloudos$
[test-æµ‹è¯•ç¯å¢ƒ]alice@server1$
[prod-ç”Ÿäº§ç¯å¢ƒ]bob@webserver$
```

### ä½¿ç”¨åœºæ™¯

1. **å¼€å‘ç¯å¢ƒ**
   ```
   [dev-å¼€å‘ç¯å¢ƒ]root@VM-0-8-opencloudos$ cd /project
   [dev-å¼€å‘ç¯å¢ƒ]root@VM-0-8-opencloudos$ ls -la
   ```

2. **å¤šç”¨æˆ·åä½œ**
   ```
   [dev-å¼€å‘ç¯å¢ƒ]alice@VM-0-8-opencloudos$ git status
   [dev-å¼€å‘ç¯å¢ƒ]bob@VM-0-8-opencloudos$ git pull
   ```

3. **è¿œç¨‹ç®¡ç†**
   ```
   [monitor-ç›‘æ§]root@production$ htop
   [log-æ—¥å¿—]admin@server$ tail -f /var/log/syslog
   ```

## ğŸ“ æ€»ç»“

âœ… **å·²è§£å†³é•¿æç¤ºç¬¦é—®é¢˜**
âœ… **æç¤ºç¬¦ç®€æ´æ˜äº†**
âœ… **ä¿ç•™æ‰€æœ‰å¿…è¦ä¿¡æ¯**
âœ… **æ”¯æŒå¤šç”¨æˆ·åä½œ**
âœ… **å®Œå…¨è‡ªå®šä¹‰**

---

**é…ç½®è„šæœ¬**ï¼š`setup_screen_prompt.sh`
**é…ç½®æ–‡ä»¶**ï¼š`~/.screenrc`, `~/.screenrc.ps1`
**è‡ªåŠ¨åŠ è½½**ï¼š`~/.bashrc`
